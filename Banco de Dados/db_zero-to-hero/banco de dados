/* Criar banco de dados */
create database cadastro
default character set utf8
default collate utf8_general_ci;

use cadastro; 
/* Criar tabela */
create table pessoas(
id int NOT NULL auto_increment, 
nome varchar(30) NOT NULL,
nascimento date,
sexo enum('F', 'M'),
peso decimal(5, 2), 
altura decimal(3, 2),
nacionalidade varchar(20) DEFAULT 'BRASIL' ,
/* Chave primaria */
primary key (id)
) default charset = utf8;

/* Inserir dado na tabela */
insert into pessoas
( id, nome, nascimento, sexo, peso, altura, nacionalidade)
values
(1,'Rodrigo', '1995-02-01','M', '104.0','1.80', 'Brasil'); 

select	* from pessoas; 

describe pessoas;

create table if not exists cursos (
nome varchar(30) not null unique,
descricao text,
carga int unsigned, 
totaulas int, 
ano year default '2016'
) DEFAULT CHARSET = utf8; 

desc cursos; 

/* Criar uma coluna na tabela (ultimo) - add column 'profissao' varchar(10); */
/* Excluir uma coluna na tabela - drop column 'profissao'; */
/* Criar uma coluna na tabela depois de algo - add column 'profissao' varchar(10) after 'altura'; */
/* Criar uma coluna na tabela antes (primeiro)- add column 'profissao' varchar(10) first; */
/* drop table if exists teste; - para apagar tabela se ela existir */ 
alter table cursos
add column idcurso int first;

alter table cursos 
add primary key (idcurso);

create table if not exists teste(
id int, 
nome varchar(10),
idade int
) DEFAULT CHARSET = utf8;

insert into teste value 
(1, 'MARIA', '22'),
(2, 'MARIA', '22'),
(3, 'MARIA', '22');

drop table if exists teste;
use cadastro;
desc pessoas;
select * from pessoas;

alter table pessoas 
add column profissão varchar(10);

alter table pessoas
drop column profissão; 

alter table pessoas 
add column profissao varchar(10) after nome;

alter table pessoas
add column codigo int first; 

alter table pessoas
modify column profissao varchar(20) not null default '';

alter table pessoas
change column profissao prof varchar(20);

alter table pessoas 
rename to gafanhotos;

desc gafanhotos;

use cadastro;
select * from gafanhotos;

alter table gafanhotos
ADD COLUMN cursopreferido int; 

alter table gafanhotos
add foreign key (cursopreferido)
references cursos(idcurso);

select g.nome, c.nome, c.ano
from gafanhotos as g inner join cursos as c
on c.idcurso = g.cursopreferido; 

select g.nome, c.nome, c.ano
from gafanhotos as g left outer join cursos as c
on c.idcurso = g.cursopreferido; 

select g.nome, c.nome, c.ano
from gafanhotos as g right outer join cursos as c
on c.idcurso = g.cursopreferido; 

create table gafanhoto_assiste_curso (
id int NOT NULL AUTO_INCREMENT, 
data date, 
idgafanhoto int, 
idcurso int, 
PRIMARY KEY (id), 
FOREIGN KEY (idgafanhoto) REFERENCES gafanhotos(id), 
FOREIGN KEY (idcurso) REFERENCES  cursos(idcurso)
) DEFAULT CHARSET = utf8;

insert into gafanhoto_assiste_curso values
(default, '2014-03-01', '1', '2');

select * from gafanhoto_assiste_curso;

/*o select vai mostrar o id do aluno, nome do aluno, nome do curso, id aluno tabela do meio, id do curso da tabela do meio tendo como referencia inicial a tabela gafanhotos com o apelido "g"*/
/*une a tabela do meio(dando um apelido para ela "a")*/
/*especificando que a chave primaria da tabela gafanhotos se ligue a chave estrangeira(idgafanhoto) da tabela do meio*/
/*une a tabela cursos(dando um apelido para ela "c"*/
/*especificando que a chave primaria da tabela cursos se ligue a chave estrangeira(idcurso) da tabela do meio*/
/*ordene os resultados pelo nome dos alunos da tabela gafanhotos*/
select g.nome, c.nome from gafanhotos as g
join gafanhoto_assiste_curso as a
on g.id = a.idgafanhoto
join cursos as c
on a.idcurso = c.idcurso;